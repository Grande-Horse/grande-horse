# 🐎 그런데 말입니다
실제 한국마사회의 경주마 데이터에 기반한 2D 도트 그래픽 경마 게임 👾  

- [짜릿한 경마의 세계로! (서비스 링크)](https://j12a606.p.ssafy.io) 🎮  
- [영상 포트폴리오 시청](https://youtu.be/BNAXOQ2jusE) 🎥  

## 🚀 주요 기능
### ➊ 경마 게임 및 실시간 채팅 💬
- 경주마 능력치와 클릭 이벤트에 기반한 멀티 레이싱 게임 
- 경마방을 생성하고 다수의 유저와 실시간 소통

|Race Room Screen|Race Screen|
|:--:|:--:|
|<img width="478" alt="race room" src="https://github.com/user-attachments/assets/7d329859-e560-4110-b016-43405cf2cd7e" />|<img width="445" alt="race screen" src="https://github.com/user-attachments/assets/535a5814-d3dc-4fa0-b51a-d6032fc4537c" />|


### ➋ 말 카드 획득 및 합성 기능 🐴
- 실제 마사회의 경주마 데이터를 바탕으로 말의 등급과 능력치 측정
- 말 카드를 합성하여 일정 확률로 더 높은 등급의 말 카드 획득

|Horse Stat Screen|Horse Combine Success Screen|
|:--:|:--:|
|<img width="379" alt="horse stat" src="https://github.com/user-attachments/assets/08365dfc-1528-4d47-b7a9-ff397f70d727" />|<img width="378" alt="Horse Combine Success" src="https://github.com/user-attachments/assets/fc79156f-b246-4eac-9fa9-efe77327e7f2" />


### ➌ 카드팩 구매 및 유저 간 거래 시스템 💰
- 포트원 기반 결제 및 코인 충전 시스템
- Chart.js 기반 특정 말 거래 변동 시세 시각화

|Coin Market Screen|Horse Purchase Screen|Horse Sell Screen|
|:--:|:--:|:--:|
|<img width="908" alt="coin" src="https://github.com/user-attachments/assets/49565dc8-cab2-44d0-9dfe-72870438507b" />|<img width="456" alt="스크린샷 2025-04-13 오후 2 35 27" src="https://github.com/user-attachments/assets/ca85e4c3-7332-4489-a8bd-bc3b801237fc" />|<img width="475" alt="스크린샷 2025-04-13 오후 2 41 01" src="https://github.com/user-attachments/assets/0d2470e0-9e15-4f68-8f30-5d6c117db265" />|


### ➍ 목장 관리 시스템 🌳
- 경주에 출전할 후보말을 최대 6마리까지 등록 
- 후보말은 목장 페이지에서 랜덤한 위치로 지속적으로 이동

|Pasture Screen|Horse Management Screen|
|:--:|:--:|
|<img width="479" alt="pasture" src="https://github.com/user-attachments/assets/422f5d44-485b-4179-8c58-ca3edd7f4eb5" />|<img width="377" alt="스크린샷 2025-04-10 오후 5 21 16" src="https://github.com/user-attachments/assets/f195df90-f8a0-4260-92ae-c81ffc865041" />|


### ➎ SSAFY, Kakao 로그인 기능 🔐
- 싸피 혹은 카카오 계정으로 손쉽게 로그인

|Landing Screen|
|:--:|
|<img width="478" alt="landing" src="https://github.com/user-attachments/assets/3ea54382-ab58-4715-bfd9-f2a27d3e4760" />|

## 🌟 성과
- 이용자 수 200명 이상 달성 📈

## 🫂 팀원 소개
|박경범|오상하|우성문|김서로|신성우|이지운|
|:--:|:--:|:--:|:--:|:--:|:--:|
|![박경범](https://github.com/user-attachments/assets/c97ccbc9-beec-46d6-aff8-589af45bab4e)<br />BE Leader <br /> <sub>총괄 팀장<sub> <br /> [![GitHub](https://img.shields.io/badge/GitHub-%23181717.svg?style=flat&logo=github&logoColor=white)](https://github.com/kyoungbeom)|![오상하](https://github.com/user-attachments/assets/14e97402-e4d9-4a34-9d2d-61b467f53896)<br />BE <br /> <sub>Data Analysis</sub> <br /> [![GitHub](https://img.shields.io/badge/GitHub-%23181717.svg?style=flat&logo=github&logoColor=white)](https://github.com/tkdgk1204)|![우성문](https://github.com/user-attachments/assets/0652388e-a12e-45a2-a776-260770cfac2a)<br />BE <br /> <sub>Infra</sub> <br /> [![GitHub](https://img.shields.io/badge/GitHub-%23181717.svg?style=flat&logo=github&logoColor=white)](https://github.com/tjdansw)|![김서로](https://github.com/user-attachments/assets/681af544-3b2b-4e60-9d0f-3a904aba86c8)<br />FE Leader <br /> <sub>Design</sub> <br /> [![GitHub](https://img.shields.io/badge/GitHub-%23181717.svg?style=flat&logo=github&logoColor=white)](https://github.com/okxooxoo)|![신성우](https://github.com/user-attachments/assets/2b0e6ff4-4fac-48e3-81da-75c3725bdb83)<br />FE <br /> <sub>Design</sub> <br /> [![GitHub](https://img.shields.io/badge/GitHub-%23181717.svg?style=flat&logo=github&logoColor=white)](https://github.com/DeongGu)|![이지운](https://github.com/user-attachments/assets/81d8d786-bf89-4897-8f38-faa6d2a251ec)<br />FE <br /> <sub>Mobile</sub> <br /> [![GitHub](https://img.shields.io/badge/GitHub-%23181717.svg?style=flat&logo=github&logoColor=white)](https://github.com/isemae)|

## 🛠️ 기술 스택
|BE|![Java](https://img.shields.io/badge/Java-%234D7896.svg?style=flat&logo=java&logoColor=white) ![Spring Boot](https://img.shields.io/badge/SpringBoot-6DB33F?style=flat&logo=SpringBoot&logoColor=white) ![Gradle](https://img.shields.io/badge/Gradle-02303A?style=flat&logo=gradle&logoColor=white) ![MySQL](https://img.shields.io/badge/MySQL-4479A1?style=flat&logo=MySQL&logoColor=white) ![Redis](https://img.shields.io/badge/Redis-FF4438?style=flat&logo=redis&logoColor=white) ![Apache Hadoop](https://img.shields.io/badge/Hadoop-66CCFF?style=flat&logo=apache-hadoop&logoColor=black)|
|:--:|:--|
|FE|![TypeScript](https://img.shields.io/badge/TypeScript-%23007ACC.svg?style=flat&logo=typescript&logoColor=white) ![React](https://img.shields.io/badge/React-61DAFB?style=flat&logo=react&logoColor=black) ![Vite](https://img.shields.io/badge/Vite-646CFF.svg?style=flat&logo=vite&logoColor=white) ![pnpm](https://img.shields.io/badge/pnpm-%23F69220.svg?style=flat&logo=pnpm&logoColor=white) ![TanStack Query](https://img.shields.io/badge/TanStackQuery-%23EF4B3D.svg?style=flat&logo=react-query&logoColor=white) ![TailwindCSS](https://img.shields.io/badge/TailwindCSS-%2338B2AC.svg?style=flat&logo=tailwind-css&logoColor=white) ![MSW](https://img.shields.io/badge/MSW-FF6A33.svg?style=flat&logo=Mock-Service-Worker&logoColor=white) ![Flutter](https://img.shields.io/badge/Flutter-02569B.svg?style=flat&logo=flutter&logoColor=white)
|Infra|![Docker](https://img.shields.io/badge/Docker-2496ED.svg?style=flat&logo=Docker&logoColor=white) ![nginx](https://img.shields.io/badge/nginx-009639.svg?style=flat&logo=nginx&logoColor=white) ![Jenkins](https://img.shields.io/badge/Jenkins-D24939.svg?style=flat&logo=Jenkins&logoColor=white)|
|Cooperation|![GitLab](https://img.shields.io/badge/GitLab-%23FC6D26.svg?style=flat&logo=gitlab&logoColor=white) ![Jira](https://img.shields.io/badge/Jira-%230052CC.svg?style=flat&logo=jira&logoColor=white) ![Figma](https://img.shields.io/badge/Figma-%23F24E1E.svg?style=flat&logo=figma&logoColor=white) ![Notion](https://img.shields.io/badge/Notion-%23000000.svg?style=flat&logo=notion&logoColor=white)|

## 💡 구현 방식
### ➊ WebSocket 기반 실시간 통신
멀티 레이싱 게임 및 실시간 채팅 기능을 구현하기 위해 단순한 폴링 방식으로 사용자 경험을 만족시키기 어렵다고 판단하였습니다.  
따라서 **WebSocket** 통신 방식을 도입하고 메시지 프로토콜을 효율적으로 관리할 수 있는 **SockJS**와 **StompJS**을 사용하였습니다.  
  
- SockJS: 웹소켓 미지원 브라우저에 대한 폴백(fallback)을 제공
- StompJS: pub/sub 기반의 구조를 통해 메시지 발행과 구독을 명확히 분리
  
STOMP의 `subscribe` 함수는 구독 시점이 중요하기 때문에 컴포넌트 단위에서 적절한 구독 시점을 찾는 것이 중요했습니다.  
사용자가 접속한 페이지에 따라 필요한 구독 정보가 달라지기 때문에,  
컴포넌트 단위에서 `subscribe`를 일괄적으로 처리하면 불필요한 구독이 발생하는 문제가 있었습니다.  
  
이를 해결하기 위해 전역 상태로 구독 목록을 관리하는 구조를 도입하여 필요한 채널만 동적으로 구독하고,  
페이지 전환 시 구독 해제 및 재구독이 자연스럽게 이루어지도록 설계하였습니다.  
  
한편, 라우팅 시에도 실시간 정보를 유지하기 위해 라우터 쿼리나 상태를 통해 정보를 전달하는 구조를 도입했습니다.  
이를 통해 페이지 간 이동하거나 재접속 할 때도 실시간 연결 상태와 필요한 데이터를 유지할 수 있었습니다.  

### ➋ 말 무작위 움직임

목장 페이지 속 살아 있는 말을 나타내기 위해 Image Sprite을 활용하여 여러 마리의 말이 랜덤한 위치로 이동하도록 구현했습니다.  
상하좌우 방향으로 이동하거나 정지하는 말 객체를 표현하기 위해 총 8가지 말의 상태를 Tailwind CSS 전역 클래스로 정의했습니다.  
이를 통해 다른 페이지에서 동일한 클래스를 불필요하게 정의하지 않고 말 클래스를 재사용할 수 있도록 설계하였습니다.  
  
|HorseRun Right|HorseRun Left|HorseRun Up|HorseRun Down|HorseIdle Right|HorseIdle Left|HorseIdle Up|HorseIdle Down|
|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|
|![horseRunRight](https://github.com/user-attachments/assets/bb54e8a8-4a3d-40c7-9d5a-58173b83bfec)|![horseRunLeft](https://github.com/user-attachments/assets/4460ee04-3bbd-44e9-8e0e-c3a5f902d978)|![horseRunUp](https://github.com/user-attachments/assets/9d7a6954-4ccf-4326-9e93-9eaa75c8e559)|![horseRunDown](https://github.com/user-attachments/assets/5a3590a5-a471-442d-816b-f81f4c2becbf)|![horseIdleRight](https://github.com/user-attachments/assets/51ed6cf5-fed0-4c4a-9eec-86c4b906755f)|![horseIdleLeft](https://github.com/user-attachments/assets/59cb421a-9ae0-4d01-9912-b0d25e77ba79)|![horseIdleUp](https://github.com/user-attachments/assets/abc4e42b-2f06-4985-bee4-541fe360d35e)|![horseIdleDown](https://github.com/user-attachments/assets/fb695967-c47b-4823-bb6b-bdcc00b279de)|
  
각각의 말이 이동하면서 서로 부딪히지 않도록 모든 말의 좌표와 바라보는 방향을 Context API을 통해 전역적으로 관리하였습니다.  
`random`, `setTimeout` 함수를 재귀적으로 활용하여 각 말이 랜덤한 주기로 이동하도록 구현하였으며,  
주변에 다른 말이나 장애물이 감지되면 정지하거나 방향을 전환하도록 설계하였습니다.  
이러한 방식으로 목장페이지에서 모든 말에 자연스러운 움직임을 부여할 수 있었습니다.  

### ➌ Suspense & Error Boundary 도입
사용자 경험 개선과 효율적인 에러 처리를 위해 Suspense와 ErrorBoundary을 도입하였습니다.  
또한 체계적으로 오류를 식별하고 다양한 예외 상황에 대처하기 위해 다양한 커스텀 에러 코드를 정의하였습니다.  
  
이러한 개발 과정에 있어서 다음과 같은 문제가 발생하였습니다.  
- 컴포넌트 마운트 후 실행되는 Data Fetching은 React의 생명 주기와 직접적인 연관이 없음
- 이로 인해 Suspense와 ErrorBoundary가 로딩 상태와 에러를 감지하지 못함
  
따라서 렌더링과 동시에 Data Fetching을 진행할 수 있도록 TanStack Query의 useSuspenseQuery hook을 사용하였습니다.  
해당 hook은 내부적으로 렌더링 중에 로딩과 에러 상태를 throw하기 때문에  
부모 컴포넌트인 Suspense와 ErrorBoundary가 이를 catch하게 됩니다.  
  
위 과정을 통해 애플리케이션 전반에 걸쳐 일관된 로딩과 에러 상태를 표시하고 사용자 경험을 크게 향상시켰습니다.  
  
|Error Screen|
|:--:|
|![image](https://github.com/user-attachments/assets/a85d5062-e7e5-47fb-aa99-c293b0dc1e94)|

### ➍ Mock Service Worker을 활용한 API 요청 테스트
Backend API 개발이 완료되기 전까지 Frontend 개발을 대기해야 하는 비효율적인 문제를 해결하기 위해  
클라이언트 사이드에서 API을 모킹할 수 있는 도구인 MSW을 도입하였습니다.  
  
MSW는 브라우저에서 제공하는 API인 Service Worker을 이용하여 클라이언트 측에서 네트워크 요청을 가로채고 모의 응답을 전송합니다.  
  
실제 API 명세서에 기반한 모의 응답을 설계함으로써 네트워크 지연이나 서버 오류와 같은 예외 상황에 대한  
통신 테스트를 수행했고 이를 통해 실제 Backend API 연동 과정에서 발생할 수 있는 문제를 사전에 최소화했습니다.  
